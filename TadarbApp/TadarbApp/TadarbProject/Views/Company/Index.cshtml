@{
    ViewData["Title"] = "الصفحة الرئيسية";
}

<head>

    <link rel="stylesheet" href="~/css/Addbranches.css" asp-append-version="true" />

</head>

<partial name="_Notification" />
<body style="background: linear-gradient(#1c4c64,#5590ad); ">

    <div class="row">

        <div class="col-sm-4" style="z-index:2;">

            <div class="vertical-nav bg-white" style="position:absolute" id="sidebar">
                <div class="py-4 px-3 mb-4 bg-light">
                    <div class="media d-flex align-items-center">
                        <img src="~/@ViewBag.OrganizationImage" alt="..." width="65" class="mr-3 rounded-circle img-thumbnail shadow-sm">
                        <div class="media-body">
                            <h4 class="m-0">@ViewBag.OrganizationName</h4>
                        </div>
                    </div>
                </div>
                <h5> مرحبا بك @ViewBag.Username </h5>

                <p class="text-gray font-weight-bold text-uppercase px-3 small pb-4 mb-0">القائمة</p>

                <ul class="nav flex-column bg-white mb-0">
                    <li class="nav-item">
                        <a asp-controller="Company" asp-action="Index" class="nav-link text-dark font-italic bg-light">
                            <i class="fa-solid fa-house  mr-3 text-primary fa-fw "></i>

                            الصفحة الرئيسية
                        </a>
                    </li>
                    <li class="nav-item" id="fff">
                        <a asp-controller="Company" asp-action="ViewSpecialities" class="nav-link text-dark font-italic ">
                            <i class="fa-brands fa-buffer mr-3  fa-fw  "></i>


                            إدارة مجالات التدريب
                        </a>
                    </li>
                    <li class="nav-item" id="ff2">
                        <a asp-controller="Company" asp-action="viewUsers" class="nav-link text-dark font-italic">
                            <i class="fa-solid fa-user-group "></i>
                            إدارة الموظفين

                        </a>
                    </li>
                    <li class="nav-item" id="ff3">
                        <a asp-controller="Company" asp-action="Viewbranches" class="nav-link text-dark font-italic ">
                            <i class="fa-solid fa-building  mr-3  fa-fw "></i>
                            إدارة الفروع
                        </a>
                    </li>

                </ul>

                <div>
                    <a class="btn " id="btn1">
                        <i class="fa-solid fa-person-circle-question"></i>
                        احتاج مساعدة

                    </a>
                </div>


            </div>


            <!-- End vertical navbar1 -->
            <!-- Page content holder1 -->
            <div class="page-content p-1" id="content">
                <!-- Toggle button -->
                <button id="sidebarCollapse" type="button" class="btn btn-light bg-white rounded-pill shadow-sm px-4 mb-4"><i class="fa fa-bars mr-2"></i><small class="text-uppercase font-weight-bold">القائمة</small></button>
            </div>


        </div>

        <div class="col-sm-8" style="margin-bottom:10cm">
            <div class="row">




                <div class="col-md-4 " style="background-color:white" id="piechart">
               
                </div>

                <div class="col-md-4 ">
                    <div class="card mb-3 text-center" style="max-width: 30rem; background: linear-gradient(#1b4860, #abc9d9
);">
                        <div class="card-body">
                            <h class="card-title" style="font-size:45px">
                                <i class="fa-solid fa-user-group "></i>
                            </h>
                            <p class="card-text" style="font-size:60px">600</p>
                            <p class="card-text" style="font-size:25px;">طلبات الالتحاق بالفرص</p>

                        </div>
                    </div>
                    <div class="card text-white bg-info mb-3 text-center" style="max-width: 30rem;background: linear-gradient(#28424f, #9fabb1);">
                        <div class="card-body">
                            <h class="card-title" style="font-size:45px">
                                <i class="fa-solid fa-user-group "></i>
                            </h>
                            <p class="card-text" style="font-size:60px">@ViewBag.OperCount</p>
                            <p class="card-text" style="font-size:25px;">الفرص المتاحة</p>

                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-4 pb-2">
                    <div class="card  mb-3 text-center" style="max-width: 30rem;background: linear-gradient(#35647b , #97d9f9); ">
                        <div class="card-body">
                            <h class="card-title" style="font-size:45px">
                                <i class="fa-solid fa-user-group "></i>
                            </h>
                            <p class="card-text" style="font-size:60px">@ViewBag.Student</p>
                            <p class="card-text" style="font-size:25px;">عدد الطلاب قيد التدريب</p>

                        </div>
                    </div>
                    <div class="card text-white  mb-3 text-center" style="max-width: 30rem;background: linear-gradient(#517e94 , #dbf1fc); ">
                        <div class="card-body">
                            <h class="card-title" style="font-size:45px">
                                <i class="fa-solid fa-user-group "></i>
                            </h>
                            <p class="card-text" style="font-size:60px">600</p>
                            <p class="card-text" style="font-size:25px;">عدد الطلاب تم تدريبهم</p>

                        </div>
                    </div>

                </div>

            </div>

            <div class="col-sm-1"></div>
        </div>
</body>
@section Scripts{

    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <script >

        google.charts.load('current', { packages: ['corechart'] });
        google.charts.setOnLoadCallback(drawChart);


        function drawChart() {


            var chart = new google.visualization.PieChart(document.getElementById('piechart'));
            //var data = [];

            var options = {
                title: 'نسب الطلاب المتدربين حسب الجامعات',
                pieHole: 0.4,
            };

                $.ajax({
                    type: 'GET',
                    url: "@Url.Action("GetStudentByUniAjax")",
          
                    dataType: "json",

                   
                  
                    success: function (data) {

                        //console.log(data.student[0].employeeAcademicSupervisor.department.organization.organizationName);


                    var dataa = new google.visualization.DataTable();

                    // Declare columns
                    dataa.addColumn('string', 'Univerty');
                    dataa.addColumn('number', 'countty');


                    //var loop=0;

                        $.each(data.student, function (key, value) {

                             //loop = loop + 1;

                        console.log(value.employeeAcademicSupervisor.department.organization.organizationName);

                        //console.log(data.length);

                        //console.log();
                        //if (dataa == value.employeeAcademicSupervisor.department.organization.organizationName) {

                        //}


                           dataa.addRows([

                            [value.employeeAcademicSupervisor.department.organization.organizationName, 1]

                              ]);

                       
                        //for (var i = 0; i < loop; i++) {


                        //    console.log(i);
                        //    i=i+1;
                        //}

                        //console.log(dataa.Wf.length);
                        //console.log(dataa.Wf[1]);


                            
                        });


                    chart.draw(dataa, options);
                    }


                })
              


         

           

           
        }
    </script>


    <script>
        $(function () {
            // Sidebar toggle behavior
            $('#sidebarCollapse').on('click', function () {
                $('#sidebar, #content').toggleClass('active');
            });
        });

        // giude tour
        document.getElementById('btn1')
            .addEventListener('click', function (event) {
                event.stopPropagation();

                const driver = new Driver();
                // Define Steps

                animate: false
                driver.defineSteps([
                    {
                        element: '#fff',
                        popover: {
                            //className: 'first-step-popover-class',
                            title: 'أولاً : اضف المجالات  ',
                            description: 'الرجاء اضافة جميع المجالات  التي تمتلكها الشركة .. علما بأن التخصصات المضافة هي التي ستظهر  للفروع ',
                            position: 'left',
                            closeBtnText: 'اغلق', // Text on the close button for this step
                            nextBtnText: 'التالي', // Next button text for this step
                            prevBtnText: 'السابق', // Previous button text for this step
                            doneBtnText: 'انتهيت', // Text on the final button


                        }
                    },
                    {
                        element: '#ff2',
                        popover: {
                            title: 'ثانياً : اضافة موظف مسؤول عن الفرع',
                            description: 'الرجاء اضافة المسؤول عن الفرع  ليتم تعيينه بالفرع المناسب لاحقاً',
                            position: 'left',
                            closeBtnText: 'اغلق', // Text on the close button for this step
                            nextBtnText: 'التالي', // Next button text for this step
                            prevBtnText: 'السابق', // Previous button text for this step
                            doneBtnText: 'انتهيت', // Text on the final button

                        }
                    },
                    {
                        element: '#ff3',
                        popover: {
                            title: 'ثالثاً : اضف الفروع  ',
                            description: 'الرجاء اضافة الفروع وتعيين مسؤول عن هذا الفرع ',
                            position: 'left',
                            closeBtnText: 'اغلق', // Text on the close button for this step
                            doneBtnText: 'انتهيت', // Text on the final button

                            nextBtnText: 'التالي', // Next button text for this step
                            prevBtnText: 'السابق', // Previous button text for this step
                        }
                    },

                ]);
                // Begin to guide
                driver.start();






            });
    </script>




    }